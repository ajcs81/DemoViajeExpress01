@{
    ViewData["Title"] = "Administrador";
    Layout = "~/Views/Shared/_LayoutDashboard.cshtml";
}

@section styles{
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.1/dist/leaflet.css"
          integrity="sha512-Rksm5RenBEKSKFjgI3a41vrjkw4EVPlJ3+OiI65vTjIdo9brlAacEuKOiQ5OFh7cOI1bkDwLqdLw3Zg0cRJAAQ=="
          crossorigin="" />
}

<div class="col-md-12">
    <div id="wizardc">
        <form id="my-form" method="post">
            <div>
                <h3>Account</h3>
                <section>
                    <label for="userName">User name *</label>
                    <input id="userName" name="userName" type="text" class="required">
                    <label for="password">Password *</label>
                    <input id="password" name="password" type="password" class="required">
                    <label for="confirm">Confirm Password *</label>
                    <input id="confirm" name="confirm" type="password" class="required">
                    <p>(*) Mandatory</p>
                </section>
                <h3>Profile</h3>
                <section>
                    <label for="name">First name *</label>
                    <input id="name" name="name" type="text" class="required">
                    <label for="surname">Last name *</label>
                    <input id="surname" name="surname" type="text" class="required">
                    <label for="email">Email *</label>
                    <input id="email" name="email" type="text" class="required email">
                    <label for="address">Address</label>
                    <input id="address" name="address" type="text">
                    <p>(*) Mandatory</p>
                </section>
                <h3>Finish</h3>
                <section>
                    <input id="acceptTerms" name="acceptTerms" type="checkbox" class="required"> <label for="acceptTerms">I agree with the Terms and Conditions.</label>
                </section>
            </div>
        </form>
    </div>
</div>
        @section Scripts{
            <script src="https://unpkg.com/leaflet@1.3.1/dist/leaflet.js"
                    integrity="sha512-/Nsx9X4HebavoBvEBuyp3I7od5tA0UzAxs+j83KgC8PU0kgB4XiK4Lfe4y4cgBtaRJQEIFCW+oC506aPT2L1zw=="
                    crossorigin=""></script>

            <script type="text/javascript">
                $(document).ready(function () {
                    var token = localStorage.getItem('id_token');
                    console.log('Este es e token: ' + token);
                    var id_usuario_rol = localStorage.getItem('id_usuario_rol');
                    let listarmodulo = document.getElementById('modulos');
                    var url = `http://localhost:59454/Modulo/ ${id_usuario_rol}`;
                    fetch(url, {
                        headers: {
                            'Content-Type': 'application/json',
                            'token': token,
                        },
                    })
                        .then((response) => {
                            return response.json();
                        })
                        .then((data) => {
                            if (data['exito']) {
                                var modul = data['data'];
                                modul.forEach((item) => {
                                    listarmodulo.innerHTML += `
                                                                        <li class="">
                                                                        <a onclick="navegar('${item['ruta']}')" class="waves-effect waves-dark">
                                                                            <span class="pcoded-micon">
                                                                                  <i class="feather icon-command"></i>
                                                                             </span>
                                                                              <span class="pcoded-mtext">${item['descripcion_modulo']} </span>
                                                                        </a>
                                                                        </li>`
                                });
                                //modul.forEach((item) => console.log(item['ruta']));
                            } else {
                                alert('Mensaje de modulo:' + data['mensaje']);
                            }
                            //console.log(data);

                        }).catch((error) => alert(error));

                });

                function navegar(ruta) {
                    location.href = `../${ruta}`;
                }
            </script>
            <script>
                var form = $("#my-form");
                form.validate({
                    errorPlacement: function errorPlacement(error, element) { element.before(error); },
                    rules: {
                        confirm: {
                            equalTo: "#password"
                        }
                    }
                });
                form.children("div").steps({
                    headerTag: "h3",
                    bodyTag: "section",
                    transitionEffect: "slideLeft",
                    onStepChanging: function (event, currentIndex, newIndex) {
                        form.validate().settings.ignore = ":disabled,:hidden";
                        alert(form.valid());
                        return form.valid();
                    },
                    onFinishing: function (event, currentIndex) {
                        form.validate().settings.ignore = ":disabled";
                        alert(form.valid());
                        return form.valid();
                    },
                    onFinished: function (event, currentIndex) {
                        alert(form.valid());
                        form.submit();
                    }
                });
            </script>
        }
